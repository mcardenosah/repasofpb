<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Repaso FPB: Nutrici√≥n y Digestivo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        /* Custom scrollbar for text analysis areas */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- CONSTANTES ---
        const QUESTIONS_PER_ROUND = 5; // N√∫mero de preguntas por ronda

        // --- BANCO DE PREGUNTAS VERIFICADO (90 PREGUNTAS TOTALES) ---
        const questionPool = {
            facil: [
                { id: 'f1', type: 'test', question: "¬øLa nutrici√≥n es un proceso voluntario o involuntario?", options: ["Voluntario", "Involuntario", "Depende del d√≠a"], answer: "Involuntario", feedback: "¬°Correcto! La nutrici√≥n es involuntaria (el cuerpo trabaja solo). La alimentaci√≥n es lo que es voluntario." },
                { id: 'f2', type: 'test', question: "¬øD√≥nde comienza la digesti√≥n?", options: ["En el est√≥mago", "En el es√≥fago", "En la boca"], answer: "En la boca", feedback: "Exacto. La digesti√≥n empieza en la boca al masticar y mezclar con saliva." },
                { id: 'f3', type: 'test', question: "¬øQu√© nutriente utilizan los m√∫sculos para construirse y repararse?", options: ["Gl√∫cidos", "Prote√≠nas", "Vitaminas"], answer: "Prote√≠nas", feedback: "Bien. Las prote√≠nas tienen funci√≥n estructural, como ladrillos para el cuerpo." },
                { id: 'f4', type: 'test', question: "¬øCu√°l de estos √≥rganos NO es parte del tubo digestivo, sino una gl√°ndula anexa?", options: ["Est√≥mago", "H√≠gado", "Intestino Delgado"], answer: "H√≠gado", feedback: "Correcto. El h√≠gado produce bilis pero la comida no pasa por dentro de √©l." },
                { id: 'f5', type: 'test', question: "¬øEl agua se considera un nutriente?", options: ["S√≠, es un nutriente regulador", "No, solo hidrata", "Solo si tiene az√∫car"], answer: "S√≠, es un nutriente regulador", feedback: "¬°S√≠! El agua es un nutriente esencial con funci√≥n reguladora." },
                { id: 'f6', type: 'test', question: "¬øQu√© funci√≥n principal tienen los l√≠pidos (grasas)?", options: ["Estructural", "Energ√©tica (reserva)", "Reguladora"], answer: "Energ√©tica (reserva)", feedback: "Correcto. Las grasas son nuestra principal reserva de energ√≠a." },
                { id: 'f7', type: 'test', question: "¬øC√≥mo se llama el proceso de tragar el alimento?", options: ["Digesti√≥n", "Degluci√≥n", "Absorci√≥n"], answer: "Degluci√≥n", feedback: "Muy bien. Degluci√≥n es el paso del bolo de la boca al es√≥fago." },
                { id: 'f8', type: 'test', question: "¬øQu√© obtenemos de los alimentos?", options: ["Nutrientes", "Solo sabor", "Solo energ√≠a"], answer: "Nutrientes", feedback: "Exacto. Los alimentos son el veh√≠culo de los nutrientes." },
                { id: 'f9', type: 'test', question: "¬øCu√°l es la funci√≥n de las vitaminas?", options: ["Dar mucha energ√≠a", "Construir m√∫sculo", "Regular el funcionamiento del cuerpo"], answer: "Regular el funcionamiento del cuerpo", feedback: "Correcto. Las vitaminas son reguladoras, imprescindibles para que todo funcione bien." },
                { id: 'f10', type: 'test', question: "¬øD√≥nde se forman las heces?", options: ["En el est√≥mago", "En el intestino delgado", "En el intestino grueso"], answer: "En el intestino grueso", feedback: "Correcto. Tras absorber el agua, los desechos forman las heces en el intestino grueso." },
                { id: 'f11', type: 'test', question: "¬øPara qu√© sirven los dientes?", options: ["Para triturar el alimento (digesti√≥n mec√°nica)", "Para saborear la comida", "Para absorber nutrientes"], answer: "Para triturar el alimento (digesti√≥n mec√°nica)", feedback: "Correcto. Cortan y trituran para facilitar el trabajo del est√≥mago." },
                { id: 'f12', type: 'test', question: "¬øQu√© tubo conecta la boca con el est√≥mago?", options: ["Tr√°quea", "Es√≥fago", "Intestino"], answer: "Es√≥fago", feedback: "El es√≥fago es el conducto de paso hacia el est√≥mago." },
                { id: 'f13', type: 'test', question: "¬øCu√°ntas comidas al d√≠a se recomienda hacer?", options: ["1 muy grande", "3 comidas", "5 comidas repartidas"], answer: "5 comidas repartidas", feedback: "Lo ideal es repartir la ingesta para mantener la energ√≠a constante." },
                { id: 'f14', type: 'test', question: "¬øCu√°l es el √≥rgano m√°s largo del tubo digestivo?", options: ["Intestino Delgado", "Est√≥mago", "Es√≥fago"], answer: "Intestino Delgado", feedback: "Puede medir entre 6 y 7 metros, ¬°est√° muy replegado!" },
                { id: 'f15', type: 'test', question: "¬øLa saliva ayuda a digerir?", options: ["S√≠, inicia la digesti√≥n qu√≠mica", "No, solo moja la comida", "Solo sirve para hablar"], answer: "S√≠, inicia la digesti√≥n qu√≠mica", feedback: "La saliva contiene sustancias que empiezan a romper los alimentos." },
                { id: 'f16', type: 'test', question: "¬øComer fruta es bueno porque aporta principalmente...?", options: ["Grasas", "Vitaminas y fibra", "Prote√≠nas"], answer: "Vitaminas y fibra", feedback: "Las frutas son ricas en nutrientes reguladores." },
                { id: 'f17', type: 'test', question: "¬øEl est√≥mago es un m√∫sculo?", options: ["S√≠, es una bolsa muscular", "No, es un hueso", "Es un cart√≠lago"], answer: "S√≠, es una bolsa muscular", feedback: "Se mueve para mezclar la comida con los jugos." },
                { id: 'f18', type: 'test', question: "¬øQu√© l√≠quido segrega el h√≠gado?", options: ["Sangre", "Bilis", "Saliva"], answer: "Bilis", feedback: "La bilis es fundamental para digerir las grasas." },
                { id: 'f19', type: 'test', question: "¬øLa respiraci√≥n es parte de la nutrici√≥n?", options: ["S√≠, aporta ox√≠geno", "No, no tiene nada que ver", "Solo si respiramos por la boca"], answer: "S√≠, aporta ox√≠geno", feedback: "La nutrici√≥n incluye digestivo, respiratorio, circulatorio y excretor." },
                { id: 'f20', type: 'test', question: "¬øDebemos beber agua solo cuando tenemos sed?", options: ["S√≠", "No, hay que beber regularmente"], answer: "No, hay que beber regularmente", feedback: "La sed ya es un s√≠ntoma de deshidrataci√≥n leve." },
                { id: 'f21', type: 'test', question: "¬øCu√°l de estos alimentos es rico en Prote√≠nas?", options: ["Pollo", "Aceite de oliva", "Manzana"], answer: "Pollo", feedback: "La carne, pescado y huevos son fuentes principales de prote√≠nas." },
                { id: 'f22', type: 'test', question: "¬øQu√© √≥rgano usamos para detectar el sabor de los alimentos?", options: ["La lengua", "Los dientes", "El paladar"], answer: "La lengua", feedback: "En la lengua est√°n las papilas gustativas." },
                { id: 'f23', type: 'test', question: "¬øQu√© nutriente es la principal fuente de energ√≠a inmediata para el cerebro?", options: ["Gl√∫cidos (az√∫car)", "Prote√≠nas", "Grasas"], answer: "Gl√∫cidos (az√∫car)", feedback: "El cerebro consume mucha glucosa para funcionar." },
                { id: 'f24', type: 'test', question: "¬øEs importante cepillarse los dientes despu√©s de comer?", options: ["S√≠, para evitar caries", "No es necesario", "Solo si comes dulces"], answer: "S√≠, para evitar caries", feedback: "La higiene bucal es parte fundamental de la salud digestiva." },
                { id: 'f25', type: 'test', question: "¬øEl arroz y la pasta qu√© tipo de nutriente aportan principalmente?", options: ["Gl√∫cidos", "Prote√≠nas", "Vitaminas"], answer: "Gl√∫cidos", feedback: "Son hidratos de carbono (gl√∫cidos) complejos." },
                { id: 'f26', type: 'test', question: "¬øD√≥nde est√° situado el est√≥mago?", options: ["En el abdomen", "En el t√≥rax", "En la pelvis"], answer: "En el abdomen", feedback: "Est√° en la cavidad abdominal, debajo del diafragma." },
                { id: 'f27', type: 'test', question: "¬øQu√© pasa con lo que el cuerpo NO puede digerir?", options: ["Se expulsa en forma de heces", "Se queda en el est√≥mago para siempre", "Se convierte en sangre"], answer: "Se expulsa en forma de heces", feedback: "Es la egesti√≥n: eliminar lo no aprovechable." },
                { id: 'f28', type: 'test', question: "¬øCu√°l de estos NO se considera t√©cnicamente un nutriente (aunque es vital)?", options: ["Fibra", "Prote√≠na", "Agua"], answer: "Fibra", feedback: "La fibra (celulosa) no la podemos digerir ni absorber, por lo que no 'nutre' a las c√©lulas, pero es vital para el tr√°nsito intestinal." },
                { id: 'f29', type: 'test', question: "¬øEl aceite de oliva es saludable?", options: ["S√≠, aporta l√≠pidos saludables", "No, engorda mucho", "Es indiferente"], answer: "S√≠, aporta l√≠pidos saludables", feedback: "Es una grasa insaturada muy buena para el coraz√≥n." },
                { id: 'f30', type: 'test', question: "¬øQu√© aparato lleva los nutrientes a todo el cuerpo?", options: ["Aparato Circulatorio", "Aparato Respiratorio", "Aparato Excretor"], answer: "Aparato Circulatorio", feedback: "La sangre transporta los nutrientes absorbidos." }
            ],
            medio: [
                { id: 'm1', type: 'short', question: "Completa la frase: La sustancia pastosa que sale del est√≥mago hacia el intestino se llama...", answer: ["quimo"], feedback: "Se llama Quimo. (El bolo es en la boca, el quilo en el intestino)." },
                { id: 'm2', type: 'test', question: "¬øCu√°l es la funci√≥n principal de los gl√∫cidos?", options: ["Estructural", "Energ√©tica inmediata", "Reguladora"], answer: "Energ√©tica inmediata", feedback: "Correcto. Los gl√∫cidos nos dan energ√≠a r√°pida para las actividades diarias." },
                { id: 'm3', type: 'short', question: "¬øQu√© √≥rgano produce la bilis?", answer: ["h√≠gado", "higado"], feedback: "El h√≠gado produce la bilis, que ayuda a disolver las grasas." },
                { id: 'm4', type: 'analysis', text: "Lee con atenci√≥n: 'El intestino grueso absorbe gran cantidad de agua de los restos de comida. Lo que queda se transforma en heces.'", question: "Seg√∫n el texto, ¬øqu√© funci√≥n nutricional importante ocurre en el intestino grueso?", options: ["Digesti√≥n de prote√≠nas", "Absorci√≥n de agua", "Formaci√≥n del quimo"], answer: "Absorci√≥n de agua", feedback: "Exacto. Recuperar el agua es vital para no deshidratarnos." },
                { id: 'm5', type: 'test', question: "¬øD√≥nde ocurre la mayor parte de la absorci√≥n de nutrientes?", options: ["Est√≥mago", "Intestino Delgado", "Intestino Grueso"], answer: "Intestino Delgado", feedback: "¬°Muy bien! El intestino delgado es la clave de la absorci√≥n." },
                { id: 'm6', type: 'short', question: "¬øC√≥mo se llama la masa de alimento triturado y mezclado con saliva en la boca?", answer: ["bolo", "bolo alimenticio"], feedback: "Es el Bolo Alimenticio." },
                { id: 'm7', type: 'test', question: "¬øQu√© jugo digestivo produce el est√≥mago?", options: ["Jugo pancre√°tico", "Bilis", "Jugo g√°strico"], answer: "Jugo g√°strico", feedback: "Correcto. El est√≥mago segrega jugos g√°stricos para formar el quimo." },
                { id: 'm8', type: 'short', question: "Escribe el nombre del nutriente que tiene funci√≥n estructural (construir tejidos).", answer: ["prote√≠nas", "proteinas", "prote√≠na", "proteina"], feedback: "Son las Prote√≠nas." },
                { id: 'm9', type: 'analysis', text: "El p√°ncreas vierte el jugo pancre√°tico en el intestino delgado.", question: "¬øEl p√°ncreas es parte del tubo por donde pasa la comida o es una f√°brica externa?", options: ["Es parte del tubo", "Es una gl√°ndula anexa (f√°brica externa)"], answer: "Es una gl√°ndula anexa (f√°brica externa)", feedback: "Exacto. La comida no entra al p√°ncreas, este solo env√≠a sus jugos al intestino." },
                { id: 'm10', type: 'test', question: "¬øQu√© ocurre en el es√≥fago?", options: ["Digesti√≥n de grasas", "Transporte del bolo al est√≥mago", "Absorci√≥n de agua"], answer: "Transporte del bolo al est√≥mago", feedback: "Bien. El es√≥fago es un tubo de paso." },
                { id: 'm11', type: 'short', question: "¬øC√≥mo se llaman los movimientos musculares que empujan la comida por el tubo digestivo?", answer: ["perist√°lticos", "peristalticos", "movimientos perist√°lticos"], feedback: "Son los movimientos perist√°lticos (como apretar un tubo de pasta de dientes)." },
                { id: 'm12', type: 'test', question: "¬øQu√© parte del intestino delgado se conecta con el est√≥mago?", options: ["Duodeno", "Yeyuno", "√çleon"], answer: "Duodeno", feedback: "El Duodeno es la primera parte, donde se vierten la bilis y el jugo pancre√°tico." },
                { id: 'm13', type: 'analysis', text: "Las vellosidades intestinales son como peque√±os pelitos en el intestino delgado.", question: "¬øPara qu√© sirven estas vellosidades?", options: ["Para mover la comida", "Para aumentar la superficie de absorci√≥n de nutrientes", "Para limpiar el intestino"], answer: "Para aumentar la superficie de absorci√≥n de nutrientes", feedback: "Funcionan como una toalla de felpa, absorbiendo mucho m√°s que si fuera liso." },
                { id: 'm14', type: 'short', question: "¬øQu√© nombre recibe la v√°lvula de entrada al est√≥mago (la que se cierra tras tragar)?", answer: ["cardias"], feedback: "Es el Cardias (impide el reflujo)." },
                { id: 'm15', type: 'test', question: "¬øCu√°l es la diferencia entre digesti√≥n mec√°nica y qu√≠mica?", options: ["La mec√°nica tritura y la qu√≠mica transforma los nutrientes", "Son lo mismo", "La qu√≠mica ocurre en la boca y la mec√°nica en el est√≥mago"], answer: "La mec√°nica tritura y la qu√≠mica transforma los nutrientes", feedback: "Mec√°nica = dientes/movimiento; Qu√≠mica = enzimas/jugos." },
                { id: 'm16', type: 'short', question: "¬øD√≥nde se almacena la bilis antes de salir al intestino?", answer: ["ves√≠cula biliar", "vesicula biliar", "ves√≠cula"], feedback: "En la Ves√≠cula Biliar." },
                { id: 'm17', type: 'test', question: "¬øPor qu√© el √°cido del est√≥mago no quema al propio est√≥mago?", options: ["Porque es de pl√°stico", "Porque tiene una capa de moco protector", "Porque el √°cido es d√©bil"], answer: "Porque tiene una capa de moco protector", feedback: "La mucosa g√°strica protege las paredes del est√≥mago." },
                { id: 'm18', type: 'analysis', text: "Las bacterias de nuestra flora intestinal viven en el intestino grueso.", question: "¬øSon perjudiciales estas bacterias?", options: ["S√≠, causan enfermedades", "No, nos ayudan a fabricar vitaminas y aprovechar residuos", "Son indiferentes"], answer: "No, nos ayudan a fabricar vitaminas y aprovechar residuos", feedback: "Vivimos en simbiosis con ellas, son beneficiosas." },
                { id: 'm19', type: 'short', question: "¬øQu√© tapadera evita que la comida se vaya a los pulmones al tragar?", answer: ["epiglotis"], feedback: "La Epiglotis." },
                { id: 'm20', type: 'test', question: "Una vez absorbidos los nutrientes, ¬øa d√≥nde van?", options: ["Al ri√±√≥n", "A la sangre", "Al exterior"], answer: "A la sangre", feedback: "Pasan a la sangre para ser repartidos a todas las c√©lulas." },
                { id: 'm21', type: 'test', question: "¬øEn qu√© zona del tubo digestivo se encuentran el Ciego, el Colon y el Recto?", options: ["Intestino Grueso", "Intestino Delgado", "Est√≥mago"], answer: "Intestino Grueso", feedback: "Son las tres partes principales del intestino grueso." },
                { id: 'm22', type: 'short', question: "¬øC√≥mo se llama el conducto com√∫n al aparato digestivo y respiratorio?", answer: ["faringe"], feedback: "La faringe es un cruce de caminos para el aire y la comida." },
                { id: 'm23', type: 'test', question: "¬øQu√© jugo digestivo ayuda a neutralizar el √°cido que viene del est√≥mago?", options: ["Jugo pancre√°tico", "Saliva", "Jugo g√°strico"], answer: "Jugo pancre√°tico", feedback: "Es vital para que el √°cido no queme el intestino delgado." },
                { id: 'm24', type: 'short', question: "Nombra la v√°lvula de salida del est√≥mago.", answer: ["p√≠loro", "piloro"], feedback: "Es el P√≠loro." },
                { id: 'm25', type: 'analysis', text: "El h√≠gado es capaz de almacenar glucosa (az√∫car) en forma de gluc√≥geno.", question: "¬øQu√© funci√≥n cumple esto?", options: ["Es una reserva de energ√≠a", "Es para fabricar bilis", "Es un desecho"], answer: "Es una reserva de energ√≠a", feedback: "Si nos falta energ√≠a, el h√≠gado libera esa reserva a la sangre." },
                { id: 'm26', type: 'test', question: "¬øQu√© son los alimentos 'reguladores'?", options: ["Los ricos en vitaminas y minerales (frutas/verduras)", "Los ricos en grasas", "Los ricos en prote√≠nas"], answer: "Los ricos en vitaminas y minerales (frutas/verduras)", feedback: "Regulan el funcionamiento qu√≠mico del cuerpo." },
                { id: 'm27', type: 'short', question: "¬øQu√© gl√°ndulas producen la saliva?", answer: ["gl√°ndulas salivales", "salivales"], feedback: "Las gl√°ndulas salivales (par√≥tidas, sublinguales...)." },
                { id: 'm28', type: 'test', question: "¬øQu√© es una √∫lcera de est√≥mago?", options: ["Una herida en la pared del est√≥mago", "Un tipo de digesti√≥n", "Una bacteria"], answer: "Una herida en la pared del est√≥mago", feedback: "Ocurre cuando falla el moco protector y el √°cido da√±a el tejido." },
                { id: 'm29', type: 'analysis', text: "Cuando tenemos diarrea, el tr√°nsito intestinal es muy r√°pido.", question: "¬øPor qu√© es peligroso?", options: ["Porque nos deshidratamos al no absorber el agua", "Porque engordamos", "Porque duele"], answer: "Porque nos deshidratamos al no absorber el agua", feedback: "La funci√≥n del intestino grueso falla y perdemos mucha agua." },
                { id: 'm30', type: 'test', question: "¬øQu√© nutriente es esencial para los huesos?", options: ["Calcio (Mineral)", "Vitamina C", "L√≠pidos"], answer: "Calcio (Mineral)", feedback: "El calcio es un mineral estructural de los huesos." }
            ],
            dificil: [
                { id: 'd1', type: 'analysis', text: "CASO PR√ÅCTICO: Juan dice: 'Como me he comido una hamburguesa gigante, estoy muy bien nutrido'.", question: "Bas√°ndote en la diferencia entre alimentaci√≥n y nutrici√≥n, ¬øpor qu√© puede estar equivocado Juan?", options: ["Porque la hamburguesa no es comida.", "Porque comer mucho (alimentaci√≥n) no garantiza que el cuerpo aproveche bien los nutrientes (nutrici√≥n).", "Porque la nutrici√≥n es voluntaria y √©l no quiso nutrirse."], answer: "Porque comer mucho (alimentaci√≥n) no garantiza que el cuerpo aproveche bien los nutrientes (nutrici√≥n).", feedback: "Exacto. Una buena alimentaci√≥n no asegura una buena nutrici√≥n si el aparato digestivo falla o la dieta no es equilibrada." },
                { id: 'd2', type: 'short', question: "Escribe el nombre del l√≠quido formado en el Intestino Delgado tras la digesti√≥n y absorci√≥n.", answer: ["quilo"], feedback: "Es el Quilo. Recuerda la secuencia: Bolo (boca) -> Quimo (est√≥mago) -> Quilo (intestino)." },
                { id: 'd3', type: 'analysis', text: "ERROR FRECUENTE: Mucha gente cree que la digesti√≥n termina en el est√≥mago.", question: "¬øQu√© ocurre realmente despu√©s del est√≥mago que es crucial para la nutrici√≥n?", options: ["Se expulsan los desechos inmediatamente.", "El alimento pasa al intestino delgado donde se completa la digesti√≥n y se absorben nutrientes.", "El h√≠gado digiere la comida directamente."], answer: "El alimento pasa al intestino delgado donde se completa la digesti√≥n y se absorben nutrientes.", feedback: "Correcto. El est√≥mago solo es una parada intermedia; lo importante ocurre en el intestino." },
                { id: 'd4', type: 'short', question: "¬øQu√© tipo de funci√≥n cumplen las Vitaminas y los Minerales?", answer: ["reguladora", "regulador"], feedback: "Funci√≥n Reguladora. Controlan que el cuerpo funcione bien." },
                { id: 'd5', type: 'test', question: "Si una persona tiene un problema y su p√°ncreas no fabrica jugo pancre√°tico, ¬øqu√© proceso se ver√° afectado?", options: ["La ingesti√≥n (tragar)", "La digesti√≥n qu√≠mica en el intestino", "La formaci√≥n de heces"], answer: "La digesti√≥n qu√≠mica en el intestino", feedback: "Muy bien. Sin jugos digestivos, no podemos romper los alimentos para sacar los nutrientes." },
                { id: 'd6', type: 'analysis', text: "Imagina que el intestino delgado de una persona est√° da√±ado y es muy corto.", question: "¬øQu√© proceso nutricional se ver√≠a m√°s afectado?", options: ["La masticaci√≥n", "La absorci√≥n de nutrientes", "La degluci√≥n"], answer: "La absorci√≥n de nutrientes", feedback: "Exacto. Al ser m√°s corto, habr√≠a menos superficie para absorber los nutrientes y pasar√≠an a las heces sin aprovecharse." },
                { id: 'd7', type: 'short', question: "¬øQu√© nutriente NO tiene funci√≥n energ√©tica ni estructural, pero es vital para el transporte y temperatura?", answer: ["agua"], feedback: "El Agua. Es un nutriente regulador esencial." },
                { id: 'd8', type: 'analysis', text: "La bilis no contiene enzimas digestivas, pero 'emulsiona' las grasas (las rompe en gotitas peque√±as).", question: "¬øPor qu√© es importante la bilis entonces?", options: ["Para dar color a las heces solamente", "Para facilitar que los jugos digestivos ataquen mejor a las grasas", "Para digerir prote√≠nas"], answer: "Para facilitar que los jugos digestivos ataquen mejor a las grasas", feedback: "Correcto. Al hacer las grasas m√°s peque√±as, la digesti√≥n es m√°s f√°cil." },
                { id: 'd9', type: 'test', question: "Diferencia clave: ¬øEn qu√© se diferencia el Quimo del Quilo?", options: ["El Quimo es en la boca y el Quilo en el est√≥mago", "El Quimo es √°cido en el est√≥mago, el Quilo contiene nutrientes listos para absorberse en el intestino", "Son lo mismo"], answer: "El Quimo es √°cido en el est√≥mago, el Quilo contiene nutrientes listos para absorberse en el intestino", feedback: "Correcto. El cambio de nombre indica el cambio de composici√≥n y lugar." },
                { id: 'd10', type: 'analysis', text: "Si comemos alimentos ricos en prote√≠nas pero no tomamos vitaminas...", question: "¬øQu√© problema podr√≠amos tener?", options: ["Nos faltar√° energ√≠a", "Fallar√° la funci√≥n reguladora del cuerpo", "Tendremos demasiada estructura"], answer: "Fallar√° la funci√≥n reguladora del cuerpo", feedback: "Bien visto. Aunque tengamos 'ladrillos' (prote√≠nas), nos faltan los 'obreros' (vitaminas) que regulan la obra." },
                { id: 'd11', type: 'analysis', text: "CASO PR√ÅCTICO: A Mar√≠a le han operado y le han quitado la ves√≠cula biliar.", question: "¬øQu√© tipo de alimentos le costar√° m√°s digerir a partir de ahora?", options: ["Las frutas", "Los alimentos muy grasos", "El agua"], answer: "Los alimentos muy grasos", feedback: "Al no tener almac√©n de bilis, la digesti√≥n de grandes cantidades de grasa es m√°s dif√≠cil." },
                { id: 'd12', type: 'test', question: "¬øQu√© es la nutrici√≥n celular?", options: ["Comer c√©lulas", "Cuando los nutrientes llegan a las c√©lulas y estas los usan para obtener energ√≠a y materia", "La digesti√≥n en el est√≥mago"], answer: "Cuando los nutrientes llegan a las c√©lulas y estas los usan para obtener energ√≠a y materia", feedback: "La nutrici√≥n termina realmente dentro de las c√©lulas." },
                { id: 'd13', type: 'short', question: "Ordena: 1.Absorci√≥n, 2.Digesti√≥n, 3.Ingesti√≥n, 4.Egesti√≥n (Defecaci√≥n). Escribe los n√∫meros en orden (ej: 1234)", answer: ["3214"], feedback: "El orden es: 3.Ingesti√≥n -> 2.Digesti√≥n -> 1.Absorci√≥n -> 4.Egesti√≥n." },
                { id: 'd14', type: 'analysis', text: "Masticar bien los alimentos facilita la digesti√≥n qu√≠mica.", question: "¬øPor qu√©?", options: ["Porque la saliva es √°cida", "Porque al trocear el alimento, aumentamos la superficie para que los jugos act√∫en mejor", "Porque as√≠ comemos menos"], answer: "Porque al trocear el alimento, aumentamos la superficie para que los jugos act√∫en mejor", feedback: "Cuanto m√°s peque√±os los trozos, mejor atacan las enzimas." },
                { id: 'd15', type: 'test', question: "¬øQu√© sucede si el peristaltismo del intestino grueso va demasiado r√°pido y no da tiempo a absorber agua?", options: ["Estre√±imiento", "Diarrea", "V√≥mito"], answer: "Diarrea", feedback: "Al no absorberse el agua, las heces salen l√≠quidas." },
                { id: 'd16', type: 'analysis', text: "El h√≠gado act√∫a como un filtro de la sangre.", question: "¬øQu√© funci√≥n tiene esto relacionado con sustancias t√≥xicas como el alcohol o medicamentos?", options: ["Las distribuye por el cuerpo", "Las desintoxica y elimina", "Las convierte en grasa"], answer: "Las desintoxica y elimina", feedback: "El h√≠gado limpia la sangre de t√≥xicos." },
                { id: 'd17', type: 'short', question: "¬øQu√© nombre recibe la v√°lvula de entrada al est√≥mago (la que a veces falla y produce reflujo)?", answer: ["cardias"], feedback: "Es el Cardias." },
                { id: 'd18', type: 'test', question: "¬øLos gl√∫cidos complejos (pasta, pan) y los simples (az√∫car) aportan lo mismo?", options: ["S√≠, energ√≠a, pero los complejos la liberan m√°s lentamente", "No, el az√∫car es grasa", "Los complejos son prote√≠nas"], answer: "S√≠, energ√≠a, pero los complejos la liberan m√°s lentamente", feedback: "Ambos son energ√©ticos, pero la absorci√≥n es distinta." },
                { id: 'd19', type: 'analysis', text: "Si una persona tiene una dieta muy pobre en fibra...", question: "¬øQu√© problema digestivo es m√°s probable que sufra?", options: ["Diarrea", "Estre√±imiento", "√ölcera"], answer: "Estre√±imiento", feedback: "La fibra ayuda a mover las heces por el intestino." },
                { id: 'd20', type: 'test', question: "¬øD√≥nde se produce la absorci√≥n de la mayor parte del agua?", options: ["Intestino Delgado", "Intestino Grueso", "Est√≥mago"], answer: "Intestino Grueso", feedback: "Aunque el delgado absorbe nutrientes, el grueso es el especialista en recuperar agua." },
                { id: 'd21', type: 'analysis', text: "La Celiaqu√≠a es una enfermedad donde el gluten da√±a las vellosidades intestinales.", question: "¬øQu√© consecuencia directa tiene esto?", options: ["Mala absorci√≥n de nutrientes (desnutrici√≥n)", "Aumento de peso", "Mejor digesti√≥n"], answer: "Mala absorci√≥n de nutrientes (desnutrici√≥n)", feedback: "Al da√±arse las vellosidades, se pierde la superficie necesaria para absorber la comida." },
                { id: 'd22', type: 'test', question: "¬øQu√© relaci√≥n hay entre el aparato digestivo y el circulatorio?", options: ["Ninguna", "El digestivo obtiene nutrientes y el circulatorio los reparte", "El circulatorio digiere la comida"], answer: "El digestivo obtiene nutrientes y el circulatorio los reparte", feedback: "Trabajan en equipo: uno prepara el combustible y el otro lo distribuye." },
                { id: 'd23', type: 'analysis', text: "La epiglotis es una tapadera que cierra la laringe al tragar.", question: "¬øQu√© pasa si comemos riendo o hablando y la epiglotis falla?", options: ["Nos atragantamos (el alimento va al pulm√≥n)", "Digesti√≥n m√°s r√°pida", "No pasa nada"], answer: "Nos atragantamos (el alimento va al pulm√≥n)", feedback: "Es un mecanismo de seguridad vital." },
                { id: 'd24', type: 'short', question: "¬øQu√© vitamina podemos fabricar nosotros mismos si tomamos el sol?", answer: ["vitamina d", "d"], feedback: "La Vitamina D es esencial y se activa con el sol." },
                { id: 'd25', type: 'analysis', text: "Los antibi√≥ticos matan bacterias malas, pero tambi√©n a las de nuestra flora intestinal.", question: "¬øQu√© efecto secundario digestivo pueden provocar?", options: ["Diarrea por desequilibrio de la flora", "Estre√±imiento severo", "Hambre excesiva"], answer: "Diarrea por desequilibrio de la flora", feedback: "Por eso a veces se toman probi√≥ticos con los antibi√≥ticos." },
                { id: 'd26', type: 'test', question: "¬øPor qu√© el intestino delgado mide 7 metros?", options: ["Para que la comida tarde mucho en salir", "Para tener much√≠sima superficie de contacto y absorber todo", "Por casualidad"], answer: "Para tener much√≠sima superficie de contacto y absorber todo", feedback: "Necesitamos mucho espacio para no perder ni un nutriente." },
                { id: 'd27', type: 'short', question: "¬øQu√© nombre recibe el movimiento inverso al peristaltismo (expulsar contenido del est√≥mago por la boca)?", answer: ["v√≥mito"], feedback: "El v√≥mito es un mecanismo de defensa contra t√≥xicos." },
                { id: 'd28', type: 'analysis', text: "El metabolismo basal es la energ√≠a que gasta el cuerpo en reposo absoluto.", question: "¬øPara qu√© sirve esa energ√≠a?", options: ["Para nada", "Para mantener funciones vitales (latir, respirar, temperatura)", "Para movernos"], answer: "Para mantener funciones vitales (latir, respirar, temperatura)", feedback: "Incluso durmiendo gastamos energ√≠a." },
                { id: 'd29', type: 'test', question: "¬øQu√© nutriente tiene m√°s calor√≠as por gramo?", options: ["Grasas (L√≠pidos)", "Gl√∫cidos", "Prote√≠nas"], answer: "Grasas (L√≠pidos)", feedback: "Las grasas aportan 9 kcal/g, frente a las 4 kcal/g de prote√≠nas y gl√∫cidos." },
                { id: 'd30', type: 'analysis', text: "La diabetes tipo 2 est√° muy relacionada con la obesidad y la mala alimentaci√≥n.", question: "¬øQu√© √≥rgano suele estar sobrecargado en esta enfermedad?", options: ["El p√°ncreas (insulina)", "El est√≥mago", "Los dientes"], answer: "El p√°ncreas (insulina)", feedback: "El p√°ncreas se agota de intentar regular tanto az√∫car en sangre." }
            ]
        };

        // --- FUNCIONES AUXILIARES ---
        
        // Funci√≥n para barajar array (Fisher-Yates shuffle)
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // --- COMPONENTES ---

        function StartScreen({ onStart }) {
            return (
                <div className="flex flex-col items-center justify-center min-h-[60vh] text-center space-y-8 fade-in p-6">
                    <div className="bg-white p-8 rounded-2xl shadow-xl max-w-lg w-full border-t-4 border-blue-500">
                        <h1 className="text-3xl font-bold text-gray-800 mb-2">Repaso: Nutrici√≥n y Digestivo</h1>
                        <p className="text-gray-600 mb-2">Selecciona el nivel de dificultad.</p>
                        <p className="text-xs text-gray-400 mb-6">Cada vez que juegues tendr√°s 5 preguntas diferentes.</p>
                        
                        <div className="grid gap-4">
                            <button 
                                onClick={() => onStart('facil')}
                                className="p-4 bg-green-100 hover:bg-green-200 text-green-800 rounded-xl font-semibold transition-all transform hover:scale-105 flex items-center justify-center gap-2"
                            >
                                <span>üå±</span> Nivel F√°cil
                            </button>
                            <button 
                                onClick={() => onStart('medio')}
                                className="p-4 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 rounded-xl font-semibold transition-all transform hover:scale-105 flex items-center justify-center gap-2"
                            >
                                <span>‚öñÔ∏è</span> Nivel Medio
                            </button>
                            <button 
                                onClick={() => onStart('dificil')}
                                className="p-4 bg-red-100 hover:bg-red-200 text-red-800 rounded-xl font-semibold transition-all transform hover:scale-105 flex items-center justify-center gap-2"
                            >
                                <span>üî•</span> Nivel Dif√≠cil
                            </button>
                        </div>
                    </div>
                    <p className="text-sm text-gray-400">FPB Ciencias Aplicadas II</p>
                </div>
            );
        }

        function QuestionCard({ data, onAnswer, currentQuestionIndex, totalQuestions }) {
            const [selectedOption, setSelectedOption] = useState(null);
            const [textAnswer, setTextAnswer] = useState("");
            const [showFeedback, setShowFeedback] = useState(false);
            const [isCorrect, setIsCorrect] = useState(false);

            useEffect(() => {
                setSelectedOption(null);
                setTextAnswer("");
                setShowFeedback(false);
                setIsCorrect(false);
            }, [data]);

            const handleCheck = () => {
                let correct = false;
                
                if (data.type === 'test' || data.type === 'analysis') {
                    if (!selectedOption) return;
                    correct = selectedOption === data.answer;
                } else if (data.type === 'short') {
                    if (!textAnswer.trim()) return;
                    const cleanUserAnswer = textAnswer.trim().toLowerCase();
                    correct = data.answer.some(ans => cleanUserAnswer === ans.toLowerCase());
                }

                setIsCorrect(correct);
                setShowFeedback(true);
            };

            const handleNext = () => {
                onAnswer(isCorrect);
            };

            return (
                <div className="w-full max-w-2xl mx-auto p-4 fade-in">
                    <div className="flex justify-between items-center mb-4 text-sm font-semibold text-gray-500">
                        <span>Pregunta {currentQuestionIndex + 1} de {totalQuestions}</span>
                        <span className={`px-2 py-1 rounded ${data.type === 'analysis' ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'}`}>
                            {data.type === 'test' ? 'Test' : data.type === 'short' ? 'Respuesta Corta' : 'An√°lisis'}
                        </span>
                    </div>

                    <div className="bg-white rounded-2xl shadow-lg p-6 mb-6">
                        {data.type === 'analysis' && (
                            <div className="bg-gray-50 p-4 rounded-lg border-l-4 border-purple-400 mb-4 italic text-gray-700">
                                {data.text}
                            </div>
                        )}

                        <h2 className="text-xl font-bold text-gray-800 mb-6">{data.question}</h2>

                        {(data.type === 'test' || data.type === 'analysis') && (
                            <div className="space-y-3">
                                {data.options.map((opt, idx) => (
                                    <button
                                        key={idx}
                                        onClick={() => !showFeedback && setSelectedOption(opt)}
                                        disabled={showFeedback}
                                        className={`w-full p-4 text-left rounded-xl border-2 transition-all ${
                                            selectedOption === opt 
                                                ? 'border-blue-500 bg-blue-50' 
                                                : 'border-gray-200 hover:border-blue-300'
                                        } ${showFeedback && opt === data.answer ? 'bg-green-100 border-green-500' : ''}
                                          ${showFeedback && selectedOption === opt && opt !== data.answer ? 'bg-red-100 border-red-500' : ''}
                                        `}
                                    >
                                        {opt}
                                    </button>
                                ))}
                            </div>
                        )}

                        {data.type === 'short' && (
                            <div className="mb-4">
                                <input
                                    type="text"
                                    value={textAnswer}
                                    onChange={(e) => setTextAnswer(e.target.value)}
                                    disabled={showFeedback}
                                    placeholder="Escribe tu respuesta aqu√≠..."
                                    className="w-full p-4 rounded-xl border-2 border-gray-300 focus:border-blue-500 focus:outline-none text-lg"
                                />
                                <p className="text-xs text-gray-500 mt-2">Respeta las tildes si es posible.</p>
                            </div>
                        )}
                    </div>

                    <div className="flex flex-col gap-4">
                        {!showFeedback ? (
                            <button 
                                onClick={handleCheck}
                                disabled={(data.type === 'short' && !textAnswer) || ((data.type === 'test' || data.type === 'analysis') && !selectedOption)}
                                className="w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 text-white font-bold rounded-xl shadow transition-colors"
                            >
                                Comprobar
                            </button>
                        ) : (
                            <div className={`p-4 rounded-xl mb-4 ${isCorrect ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'} fade-in`}>
                                <div className="font-bold text-lg mb-1">
                                    {isCorrect ? '¬°Correcto! üéâ' : 'Incorrecto üòÖ'}
                                </div>
                                <p className="mb-4">{data.feedback}</p>
                                <button 
                                    onClick={handleNext}
                                    className="w-full py-3 bg-gray-800 hover:bg-gray-900 text-white font-bold rounded-xl shadow transition-colors"
                                >
                                    {currentQuestionIndex + 1 === totalQuestions ? 'Ver Resultados' : 'Siguiente Pregunta'}
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        function Results({ score, total, level, onReset }) {
            const percentage = (score / total) * 100;
            let message = "";
            if (percentage === 100) message = "¬°Excelente! Dominas el tema a la perfecci√≥n.";
            else if (percentage >= 70) message = "¬°Muy bien! Est√°s listo para el examen.";
            else if (percentage >= 50) message = "Bien, pero repasa los errores.";
            else message = "Necesitas repasar un poco m√°s. ¬°√Ånimo!";

            return (
                <div className="flex flex-col items-center justify-center min-h-[60vh] text-center p-6 fade-in">
                    <div className="bg-white p-8 rounded-2xl shadow-xl max-w-lg w-full">
                        <h2 className="text-2xl font-bold text-gray-800 mb-4">Resultados: Nivel {level}</h2>
                        
                        <div className="relative w-32 h-32 mx-auto mb-6 flex items-center justify-center rounded-full border-8 border-blue-100">
                            <span className="text-4xl font-bold text-blue-600">{score}/{total}</span>
                        </div>

                        <p className="text-xl font-medium text-gray-700 mb-2">{message}</p>
                        <p className="text-gray-500 mb-8">Has acertado el {percentage}% de las preguntas.</p>

                        <button 
                            onClick={onReset}
                            className="w-full py-3 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl shadow transition-colors"
                        >
                            Volver al Inicio
                        </button>
                    </div>
                </div>
            );
        }

        function App() {
            const [gameState, setGameState] = useState('home');
            const [level, setLevel] = useState('facil');
            const [activeQuestions, setActiveQuestions] = useState([]);
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [score, setScore] = useState(0);

            const startQuiz = (selectedLevel) => {
                setLevel(selectedLevel);
                
                // 1. Obtener todas las preguntas del nivel
                const allLevelQuestions = questionPool[selectedLevel];
                // 2. Barajarlas
                const shuffled = shuffleArray(allLevelQuestions);
                // 3. Seleccionar las primeras X preguntas (ej. 5)
                const selected = shuffled.slice(0, QUESTIONS_PER_ROUND);

                setActiveQuestions(selected);
                setCurrentQuestionIndex(0);
                setScore(0);
                setGameState('quiz');
            };

            const handleAnswer = (isCorrect) => {
                if (isCorrect) setScore(s => s + 1);
                
                if (currentQuestionIndex + 1 < activeQuestions.length) {
                    setCurrentQuestionIndex(c => c + 1);
                } else {
                    setGameState('results');
                }
            };

            return (
                <div className="min-h-screen pb-10">
                    <header className="bg-white shadow-sm py-4 mb-6">
                        <div className="container mx-auto px-4 flex justify-between items-center">
                            <span className="font-bold text-xl text-blue-600">FPB Ciencias</span>
                            {gameState !== 'home' && (
                                <button onClick={() => setGameState('home')} className="text-sm text-gray-500 hover:text-gray-800">
                                    Salir
                                </button>
                            )}
                        </div>
                    </header>

                    <main className="container mx-auto px-4">
                        {gameState === 'home' && <StartScreen onStart={startQuiz} />}
                        
                        {gameState === 'quiz' && activeQuestions.length > 0 && (
                            <QuestionCard 
                                data={activeQuestions[currentQuestionIndex]} 
                                onAnswer={handleAnswer}
                                currentQuestionIndex={currentQuestionIndex}
                                totalQuestions={activeQuestions.length}
                            />
                        )}

                        {gameState === 'results' && (
                            <Results 
                                score={score} 
                                total={activeQuestions.length} 
                                level={level.charAt(0).toUpperCase() + level.slice(1)}
                                onReset={() => setGameState('home')} 
                            />
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
